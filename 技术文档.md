<p align="center">
  <img src="app_gui/assets/snowfox-icon-v3.png" width="128" alt="SnowFox">
</p>

# SnowFox 鈥?娑叉爱鍐诲瓨搴撳瓨绠＄悊

[浜у搧棣栭〉](README.md)

> 闈㈠悜鐢熺墿瀹為獙瀹ょ殑娑叉爱鍐诲瓨绠″簱瀛樼鐞嗙郴缁燂細妗岄潰 GUI + AI Copilot锛屽叡浜竴濂?Tool API锛屾墍鏈夊啓鎿嶄綔缁忚繃鏍￠獙銆佸浠姐€佸璁°€?

## 浜偣

- **Tube 绾ф暟鎹ā鍨?* 鈥?涓€鏉¤褰?= 涓€鏀墿鐞嗗喕瀛樼锛屼綅缃簿纭埌鐩掑唴鏍间綅
- **鍙屽墠绔叡浜?API** 鈥?妗岄潰 GUI锛圥ySide6锛? 鍐呭祵 AI Copilot锛圖eepSeek / 鏅鸿氨 GLM锛?
- **缁熶竴 Tool API** 鈥?鎵€鏈夊墠绔叡浜?`lib/tool_api.py`锛岃涓轰竴鑷淬€佺粨鏋滄牸寮忕粺涓€
- **鍐欐搷浣滃畨鍏ㄩ摼** 鈥?姣忔鍐欏叆锛氭牎楠?鈫?澶囦唤 鈫?鍐欏叆 鈫?瀹¤锛屽叏绋嬪彲杩芥函
- **涓嫳鏂囧弻璇?* 鈥?GUI 鐣岄潰銆佸彇鍑哄姩浣溿€佹悳绱㈠潎鏀寔涓嫳鏂?
- **鍗曟枃浠跺瓨鍌?* 鈥?鏁版嵁瀛樻斁鍦ㄤ竴涓?YAML 鏂囦欢涓紝鏄撲簬鐗堟湰鎺у埗鍜岃縼绉?

---

## 蹇€熷紑濮?

### 1. 瀹夎渚濊禆

```bash
pip install -r requirements.txt   # PyYAML, mistune
```

### 2. 鍑嗗鏁版嵁鏂囦欢

```bash
# 浣跨敤 demo 鏁版嵁蹇€熶綋楠?
cp demo/ln2_inventory.demo.yaml my_inventory.yaml
```

### 3. 鍚姩 GUI

```bash
pip install PySide6
python app_gui/main.py
```

绋嬪簭浼氳鍙?GUI 閰嶇疆涓殑 `yaml_path`銆傞娆″惎鍔ㄦ椂锛孏UI 浼氬紩瀵间綘閫夋嫨鎴栧垱寤烘暟鎹枃浠躲€?

---

## 鍔熻兘鐗规€?

### 搴撳瓨绠＄悊

- 娣诲姞鍐诲瓨绠★紙鏀寔鎵归噺澶氫綅缃級
- 鍙栧嚭 / 澶嶈嫃 / 鎵旀帀 / 绉诲姩锛堝崟鏉′笌鎵归噺锛?
- 缂栬緫璁板綍鍏冩暟鎹紙鍐诲瓨鏃ユ湡銆佸娉ㄣ€佽嚜瀹氫箟瀛楁绛夛級
- 浣嶇疆鍐茬獊妫€娴?鈥?鍚屼竴鏍间綅涓嶅厑璁搁噸澶嶅崰鐢?
- 绌轰綅鏌ヨ涓庢櫤鑳芥帹鑽愶紙杩炵画浣嶇疆 / 鎸囧畾鐩掑瓙鍋忓ソ锛?
- 鎼滅储锛堟ā绯?/ 绮剧‘ / 鍏抽敭璇?AND锛?
- 缁熻姒傝锛堝崰鐢ㄧ巼銆佸悇鐩掑垎甯冦€佽繎鏈熷喕瀛?鍙栧嚭瓒嬪娍锛?
- 鏃堕棿绾垮洖婧紙鎸夊ぉ鏁版垨鍏ㄩ噺鍘嗗彶锛?

### AI Copilot 鏅鸿兘鍔╂墜

- 鑷劧璇█瀵硅瘽鎿嶄綔搴撳瓨锛?甯垜鎶?3 鍙风洅绗?5 绠″彇鍑?锛?
- 鍐欐搷浣滆嚜鍔ㄦ殏瀛?鈥?涓嶇洿鎺ユ墽琛岋紝闇€浜哄伐纭
- 鏀寔 DeepSeek 鍜屾櫤璋?GLM 涓や釜妯″瀷鎻愪緵鍟?
- 娴佸紡杈撳嚭 + 鎬濈淮閾惧睍绀?

### 鏁版嵁瀹夊叏

- 姣忔鍐欐搷浣滃墠鑷姩澶囦唤锛堜繚鐣欐渶杩?200 浠斤級
- JSONL 瀹¤鏃ュ織锛堣褰曟搷浣滆€呫€佷細璇濄€佽拷韪?ID锛?
- 涓€閿洖婊氬埌浠绘剰澶囦唤蹇収
- 鍐欏叆鍓嶅畬鏁存€ф牎楠岋紙ID 鍞竴鎬с€佷綅缃啿绐併€佹棩鏈熸牸寮忕瓑锛?

### GUI 鍔熻兘

- 9脳9 缃戞牸鍙鍖栵紙姣忕洅 81 涓綅缃級
- 娣辫壊 / 娴呰壊 / 璺熼殢绯荤粺涓婚
- 鍥介檯鍖栵紙鑻辨枃銆佺畝浣撲腑鏂囷級
- 鎿嶄綔璁″垝鏆傚瓨 鈫?棰勮 鈫?鎵归噺鎵ц 鈫?鎾ら攢
- CSV / HTML 瀵煎嚭
- 鑷畾涔夊瓧娈电鐞?

---

## 鏋舵瀯璁捐

### 鍥涘眰鏋舵瀯

```
鈹屸攢鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹?
鈹?                   鍓嶇灞?(Frontends)                  鈹?
鈹? 鈹屸攢鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹? 鈹屸攢鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹? 鈹?
鈹? 鈹?  妗岄潰 GUI    鈹? 鈹?       AI Copilot            鈹? 鈹?
鈹? 鈹? (PySide6)   鈹? 鈹?     (ReAct Agent)           鈹? 鈹?
鈹? 鈹斺攢鈹€鈹€鈹€鈹€鈹€鈹攢鈹€鈹€鈹€鈹€鈹€鈹€鈹? 鈹斺攢鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹攢鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹? 鈹?
鈹?        鈹?                       鈹?                  鈹?
鈹溾攢鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹粹攢鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹粹攢鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹?
鈹?                 閫傞厤灞?(Adapters)                     鈹?
鈹? tool_bridge.py        tool_runner.py                鈹?
鈹? (GUI actor 鏍囪)       (Agent 璋冨害 + 璁″垝鏆傚瓨)        鈹?
鈹溾攢鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹?
鈹?              缁熶竴 Tool API (lib/tool_api.py)         鈹?
鈹? add_entry 路 record_takeout 路 batch_takeout 路 edit_entry   鈹?
鈹? query_inventory 路 search_records 路 generate_stats   鈹?
鈹? rollback 路 recommend_positions 路 ...                鈹?
鈹溾攢鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹?
鈹?                 鍩虹灞?(Foundation)                   鈹?
鈹? yaml_ops.py    validators.py    config.py           鈹?
鈹? (YAML I/O +    (鏍￠獙 + 鏃ユ湡     (杩愯鏃堕厤缃?          鈹?
鈹?  澶囦唤 + 瀹¤)    瑙ｆ瀽)            浼樺厛绾у悎骞?          鈹?
鈹? takeout_parser.py  operations.py   custom_fields.py    鈹?
鈹? (鍔ㄤ綔褰掍竴鍖?     (ID/浣嶇疆鏌ユ壘)    (鑷畾涔夊瓧娈?         鈹?
鈹斺攢鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹?
                         鈹?
                         鈻?
              <user-selected>.yaml (搴撳瓨鏁版嵁鏂囦欢)
```

### 缁熶竴 Tool API

鎵€鏈夊伐鍏峰嚱鏁颁綅浜?`lib/tool_api.py`锛岃繑鍥炵粺涓€鏍煎紡锛?

```python
{
    "ok": True,           # 鎿嶄綔鏄惁鎴愬姛
    "result": { ... },    # 鎴愬姛鏃剁殑鏁版嵁
    "error_code": "...",  # 澶辫触鏃剁殑閿欒鐮?
    "message": "..."      # 浜虹被鍙鐨勬秷鎭?
}
```

### 鏁版嵁娴?

```
鐢ㄦ埛鎿嶄綔 鈫?鍓嶇閫傞厤 鈫?Tool API 鈫?鏍￠獙 鈫?澶囦唤 鈫?鍐欏叆 YAML 鈫?瀹¤鏃ュ織
                                   鈫?(澶辫触)
                              杩斿洖閿欒鐮?+ 鎻愮ず
```

鍐欐搷浣滃湪 AI Copilot 涓細琚嫤鎴苟鏆傚瓨鍒拌鍒掗槦鍒楋紝绛夊緟鐢ㄦ埛鍦?GUI 涓‘璁ゅ悗鎵嶆墽琛屻€?

---

## 鏁版嵁妯″瀷

### YAML 缁撴瀯

```yaml
meta:
  box_layout:
    rows: 9
    cols: 9
  custom_fields:          # 鍙€夛細鐢ㄦ埛鑷畾涔夊瓧娈?
    - key: "project"
      label: "椤圭洰"
      type: "text"
      required: false

inventory:
  - id: 1
    cell_line: "NCCIT"
    short_name: "NCCIT_ctrl_A"
    plasmid_name: "pLenti-empty"
    plasmid_id: "p0001"
    box: 1
    position: 1
    frozen_at: "2026-02-01"
    note: "baseline control clone"
    thaw_events: null
```

### Tube 绾фā鍨?

姣忔潯 `inventory[]` 璁板綍浠ｈ〃涓€鏀墿鐞嗗喕瀛樼锛?

| 瀛楁 | 绫诲瀷 | 璇存槑 |
|------|------|------|
| `id` | int | 鑷鍞竴 ID锛堝繀濉級 |
| `box` | int | 鐩掑瓙缂栧彿锛堝繀濉紝榛樿 1-5锛?|
| `frozen_at` | str | 鍐诲瓨鏃ユ湡锛堝繀濉紝YYYY-MM-DD锛?|
| `position` | int/null | 鐩掑唴浣嶇疆锛堝彇鍑哄悗涓?null锛?|
| `cell_line` | str | 缁嗚優绯伙紙鍙厤缃负蹇呭～锛?|
| `short_name` | str | 绠€绉帮紙鐢ㄤ簬缃戞牸鏄剧ず锛?|
| `plasmid_name` | str | 璐ㄧ矑鍚嶇О |
| `plasmid_id` | str | 璐ㄧ矑缂栧彿 |
| `note` | str | 澶囨敞 |
| `thaw_events` | list | 鍙栧嚭/绉诲姩浜嬩欢鍒楄〃 |

### 鍙栧嚭/绉诲姩浜嬩欢

`thaw_events` 璁板綍姣忔瀵瑰喕瀛樼鐨勬搷浣滐細

```yaml
thaw_events:
  - date: "2026-02-10"
    action: "takeout"       # takeout / move
    positions: [1]
```

鍥涚鍔ㄤ綔鏀寔涓嫳鏂囪緭鍏ワ細

| 涓枃 | 鑻辨枃 | 璇存槑 |
|------|------|------|
| 鍙栧嚭 | takeout | 浠庢恫姘綈鍙栧嚭 |
| 绉诲姩 | move | 绉诲姩鍒板叾浠栦綅缃?鐩掑瓙 |

### 鑷畾涔夊瓧娈?

閫氳繃 `meta.custom_fields` 瀹氫箟棰濆瀛楁锛屾墍鏈夊墠绔嚜鍔ㄨ瘑鍒€傚湪 GUI 鐨?Settings > Manage Fields 涓鐞嗐€?

---

## Tool API 鍙傝€?

### 鍐欏叆宸ュ叿

| 宸ュ叿鍚?| 璇存槑 | 鍏抽敭鍙傛暟 |
|--------|------|----------|
| `tool_add_entry` | 娣诲姞鍐诲瓨绠?| `box`, `positions`, `frozen_at`, `fields` |
| `tool_record_takeout` | 璁板綍鍙栧嚭/澶嶈嫃 | `record_id`, `date`, `action`, `position` |
| `tool_batch_takeout` | 鎵归噺鍙栧嚭/澶嶈嫃 | `entries`, `date`, `action` |
| `tool_edit_entry` | 缂栬緫璁板綍瀛楁 | `record_id`, `fields` |
| `tool_rollback` | 鍥炴粴鍒板浠?| `backup_path` |
| `tool_adjust_box_count` | 澧炲噺鐩掑瓙鏁伴噺 | `operation`, `count`/`box` |

### 璇诲彇宸ュ叿

| 宸ュ叿鍚?| 璇存槑 | 鍏抽敭鍙傛暟 |
|--------|------|----------|
| `tool_query_inventory` | 鏌ヨ搴撳瓨璁板綍 | `box`, `position`, `cell_line` |
| `tool_search_records` | 鏂囨湰鎼滅储 | `query`, `mode`, `max_results` |
| `tool_list_empty_positions` | 鍒楀嚭绌轰綅 | `box` |
| `tool_recommend_positions` | 鎺ㄨ崘绌轰綅 | `count`, `box_preference`, `strategy` |
| `tool_recent_frozen` | 杩戞湡鍐诲瓨 | `days`, `count` |
| `tool_query_takeout_events` | 鏌ヨ鍙栧嚭浜嬩欢 | `date`, `days`, `action` |
| `tool_collect_timeline` | 鏃堕棿绾挎眹鎬?| `days`, `all_history` |
| `tool_generate_stats` | 缁熻姒傝 | 鈥?|
| `tool_get_raw_entries` | 鑾峰彇鍘熷璁板綍 | `ids` |
| `tool_list_backups` | 鍒楀嚭澶囦唤 | 鈥?|
| `tool_export_inventory_csv` | 瀵煎嚭 CSV | 鈥?|

<details>
<summary>鎵归噺鎿嶄綔 entries 鏍煎紡璇存槑</summary>

`batch_takeout` 鐨?`entries` 鍙傛暟鏀寔澶氱鏍煎紡锛?

```
# 浠?ID锛堣嚜鍔ㄦ帹鏂綅缃級
"182,183"

# ID:浣嶇疆
"182:23,183:41"

# ID:婧愪綅缃?>鐩爣浣嶇疆锛堝悓鐩掔Щ鍔級
"182:23->31,183:41->42"

# ID:婧愪綅缃?>鐩爣浣嶇疆:鐩爣鐩掞紙璺ㄧ洅绉诲姩锛?
"182:23->31:2,183:41->42:3"
```

涔熸敮鎸?list/dict 鏍煎紡锛?
```python
# list 鏍煎紡
[[182, 23], [183, 41]]

# dict 鏍煎紡
[{"record_id": 182, "position": 23}, {"record_id": 183, "position": 41}]
```

</details>

---

## GUI 浣跨敤鎸囧崡

### 鎬昏闈㈡澘锛圤verview锛?

- 9脳9 缃戞牸灞曠ず姣忎釜鐩掑瓙鐨勪綅缃崰鐢ㄦ儏鍐?
- 鐐瑰嚮鏍间綅鏌ョ湅璇︽儏锛屽閫夋牸浣嶅彲鎵归噺鎿嶄綔
- 椤堕儴绛涢€夋爮鎸夌洅瀛愩€佺粏鑳炵郴杩囨护
- 棰滆壊鍖哄垎锛氬凡鍗犵敤 / 绌轰綅 / 宸插彇鍑?

### 鎿嶄綔闈㈡澘锛圤perations锛?

- 娣诲姞鍐诲瓨绠★細濉啓鐩掑瓙銆佷綅缃€佸喕瀛樻棩鏈熷拰鍏朵粬瀛楁
- 鍙栧嚭/澶嶈嫃锛氶€夋嫨璁板綍鍜屽姩浣滅被鍨?
- 绉诲姩锛氭敮鎸佸悓鐩掑拰璺ㄧ洅绉诲姩
- 璁″垝鏆傚瓨鍖猴細鎿嶄綔鍏堣繘鍏ユ殏瀛橀槦鍒楋紝棰勮纭鍚庢壒閲忔墽琛?
- 鎾ら攢锛氭墽琛屽悗鍙竴閿洖婊?
- 瀵煎嚭锛欳SV 鍜?HTML 鏍煎紡

### AI Copilot 闈㈡澘

- 鑷劧璇█瀵硅瘽锛屾祦寮忚緭鍑?
- 鎬濈淮閾撅紙Thinking锛夊彲灞曞紑鏌ョ湅
- 鍐欐搷浣滆嚜鍔ㄦ殏瀛樺埌璁″垝闃熷垪
- 宸ュ叿璋冪敤杩囩▼瀹炴椂灞曠ず

### 璁剧疆

- 鏁版嵁鏂囦欢璺緞
- AI 鎻愪緵鍟嗗拰妯″瀷閫夋嫨
- API Key 绠＄悊
- 璇█鍜屼富棰樺垏鎹?
- 鑷畾涔夊瓧娈电鐞?
- 鑷畾涔?AI 鎻愮ず璇?

---

## AI Copilot 鏅鸿兘鍔╂墜

### 鏀寔鐨勬ā鍨?

| 鎻愪緵鍟?| 榛樿妯″瀷 | 鐜鍙橀噺 |
|--------|----------|----------|
| DeepSeek | `deepseek-chat` | `DEEPSEEK_API_KEY` |
| 鏅鸿氨 GLM | `glm-5` | `ZHIPUAI_API_KEY` |

鍦?GUI 璁剧疆涓€夋嫨鎻愪緵鍟嗗苟濉叆 API Key锛屾垨閫氳繃鐜鍙橀噺閰嶇疆锛?

```bash
# DeepSeek
export DEEPSEEK_API_KEY="sk-..."

# 鏅鸿氨 GLM
export ZHIPUAI_API_KEY="..."
```

### 宸ヤ綔鍘熺悊锛圧eAct 寰幆锛?

AI Copilot 鍩轰簬 ReAct锛圧easoning + Acting锛夋ā寮忚繍琛岋細

```
鐢ㄦ埛娑堟伅 鈫?LLM 鎺ㄧ悊 鈫?璋冪敤宸ュ叿 鈫?瑙傚療缁撴灉 鈫?缁х画鎺ㄧ悊鎴栧洖绛?
                鈫?                             鈹?
                鈹斺攢鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹€鈹?
                      (鏈€澶?12 姝ュ惊鐜?
```

- LLM 閫氳繃鍘熺敓宸ュ叿璋冪敤锛坒unction calling锛変笌搴撳瓨浜や簰
- 鏀寔骞惰宸ュ叿璋冪敤锛圱hreadPoolExecutor锛?
- 宸ュ叿缁撴灉鍖呭惈 `_hint` 瀛楁锛屽府鍔?LLM 浠庨敊璇腑鎭㈠

### 璁″垝鏆傚瓨鏈哄埗

鍐欐搷浣滐紙娣诲姞銆佸彇鍑恒€佺紪杈戙€佸洖婊氾級鍦?AI Copilot 涓笉浼氱洿鎺ユ墽琛岋細

1. AI 璋冪敤鍐欏叆宸ュ叿 鈫?鎿嶄綔琚嫤鎴苟鏆傚瓨鍒拌鍒掗槦鍒?
2. AI 鍥炲"宸叉殏瀛橈紝璇蜂汉宸ョ‘璁ゆ墽琛?
3. 鐢ㄦ埛鍦ㄦ搷浣滈潰鏉跨殑璁″垝鍖烘煡鐪嬨€侀瑙?
4. 纭鎵ц 鈫?瀹為檯鍐欏叆 YAML
5. 鎵ц鍚庡彲鎾ら攢锛堝洖婊氬埌鎵ц鍓嶇殑澶囦唤锛?

杩欑‘淇濅簡 AI 涓嶄細鍦ㄦ湭缁忕‘璁ょ殑鎯呭喌涓嬩慨鏀规暟鎹€?

---

## 閰嶇疆璇存槑

### 杩愯鏃堕厤缃紙LN2_CONFIG_FILE锛?

閫氳繃鐜鍙橀噺鎸囧悜涓€涓?JSON 鏂囦欢锛岃鐩栭粯璁ら厤缃細

```bash
export LN2_CONFIG_FILE=/path/to/config.json
```

```json
{
  "yaml_path": "/data/inventory.yaml",
  "schema": {
    "box_range": [1, 10],
    "position_range": [1, 81]
  },
  "safety": {
    "backup_keep_count": 200,
    "total_empty_warning_threshold": 20,
    "box_empty_warning_threshold": 5,
    "yaml_size_warning_mb": 5
  }
}
```

閰嶇疆浼樺厛绾э細鍐呯疆榛樿鍊?鈫?`LN2_CONFIG_FILE` JSON 鈫?PyInstaller 鍐荤粨妫€娴嬨€?

### GUI 閰嶇疆锛垀/.ln2agent/config.yaml锛?

GUI 鐨勬寔涔呭寲閰嶇疆瀛樺偍鍦?`~/.ln2agent/config.yaml`锛?

```yaml
yaml_path: /data/inventory.yaml
language: zh-CN          # en | zh-CN
theme: dark              # dark | light | auto
api_keys:
  deepseek: "sk-..."
  zhipu: "..."
ai:
  provider: deepseek     # deepseek | zhipu
  model: deepseek-chat
  max_steps: 12
  thinking_enabled: true
  custom_prompt: ""
```

### 鐜鍙橀噺

| 鍙橀噺 | 璇存槑 |
|------|------|
| `LN2_CONFIG_FILE` | 杩愯鏃堕厤缃?JSON 璺緞 |
| `DEEPSEEK_API_KEY` | DeepSeek API 瀵嗛挜 |
| `DEEPSEEK_MODEL` | DeepSeek 妯″瀷鍚嶏紙榛樿 `deepseek-chat`锛?|
| `DEEPSEEK_BASE_URL` | DeepSeek API 鍦板潃锛堥粯璁ゅ畼鏂癸級 |
| `ZHIPUAI_API_KEY` | 鏅鸿氨 API 瀵嗛挜 |

---

## 澶囦唤涓庡璁?

### 鑷姩澶囦唤

姣忔鍐欐搷浣滃墠锛岀郴缁熻嚜鍔ㄥ皢褰撳墠 YAML 鏂囦欢澶嶅埗鍒板浠界洰褰曪細

```
ln2_inventory_backups/
鈹溾攢鈹€ ln2_inventory_20260210_143022.yaml
鈹溾攢鈹€ ln2_inventory_20260210_142815.yaml
鈹斺攢鈹€ ...
```

榛樿淇濈暀鏈€杩?200 浠藉浠斤紝瓒呭嚭鍚庤嚜鍔ㄨ疆杞垹闄ゆ渶鏃х殑銆?

### JSONL 瀹¤鏃ュ織

鎵€鏈夊啓鎿嶄綔璁板綍鍒?`ln2_inventory_audit.jsonl`锛?

```json
{
  "timestamp": "2026-02-10T14:30:22",
  "action": "add_entry",
  "tool_name": "tool_add_entry",
  "actor_type": "human",
  "actor_id": "human",
  "channel": "gui",
  "session_id": "session-20260210143000-a1b2c3d4",
  "trace_id": "trace-e5f6a7b8",
  "status": "success",
  "details": { ... }
}
```

瀹¤鏃ュ織鍖哄垎鎿嶄綔鏉ユ簮锛坄actor_type`: human / agent锛夊拰娓犻亾锛坄channel`: gui / agent / cli锛夈€?

### 鍥炴粴

閫氳繃 `tool_rollback` 鎴?GUI 鎿嶄綔闈㈡澘鍥炴粴鍒颁换鎰忓浠藉揩鐓с€傚洖婊氭湰韬篃浼氳Е鍙戝浠藉拰瀹¤璁板綍銆?

---

## 鍥介檯鍖?

GUI 鏀寔鑻辨枃鍜岀畝浣撲腑鏂囷紝缈昏瘧鏂囦欢浣嶄簬锛?

```
app_gui/i18n/translations/
鈹溾攢鈹€ en.json
鈹斺攢鈹€ zh-CN.json
```

鍦?GUI 璁剧疆涓垏鎹㈣瑷€锛屾垨淇敼 `~/.ln2agent/config.yaml` 涓殑 `language` 瀛楁銆?

浠ｇ爜涓娇鐢?`tr("key.subkey")` 寮曠敤缈昏瘧鏂囨湰銆?

---

## 娴嬭瘯

```bash
# 杩愯鍏ㄩ儴娴嬭瘯
pytest tests/

# 杩愯鍗曚釜娴嬭瘯鏂囦欢
pytest tests/test_tool_api.py -v

# 杩愯鍗曚釜娴嬭瘯鐢ㄤ緥
pytest tests/test_tool_api.py::TestToolAddEntry::test_basic_add -v

# GUI 鐩稿叧娴嬭瘯锛堥渶瑕?PySide6锛?
pytest tests/test_gui_panels.py -v
```

娴嬭瘯浣跨敤鐪熷疄 YAML 鏂囦欢锛堜复鏃剁洰褰曪級锛屼笉渚濊禆 mock 妗嗘灦銆?

---

## 鎵撳寘鍙戝竷

### PyInstaller锛圵indows EXE锛?

```bash
pip install pyinstaller
pyinstaller ln2_inventory.spec
```

鏋勫缓浜х墿浣嶄簬 `dist/` 鐩綍锛岄噰鐢?onedir 妯″紡銆?

### Inno Setup 瀹夎鍖?

浣跨敤 Inno Setup 鑴氭湰鐢熸垚 Windows 瀹夎绋嬪簭锛?

```bat
"C:\Program Files (x86)\Inno Setup 6\ISCC.exe" installer\windows\LN2InventoryAgent.iss
```

杈呭姪鑴氭湰锛歚installer/windows/build_installer.bat`

---

## 椤圭洰缁撴瀯

```
snowfox/
鈹溾攢鈹€ lib/                        # 鍏变韩搴?
鈹?  鈹溾攢鈹€ tool_api.py             # 缁熶竴 Tool API锛堝簳灞傚伐鍏峰嚱鏁伴泦鍚堬級
鈹?  鈹溾攢鈹€ config.py               # 杩愯鏃堕厤缃紙浼樺厛绾у悎骞讹級
鈹?  鈹溾攢鈹€ yaml_ops.py             # YAML I/O + 澶囦唤 + 瀹¤
鈹?  鈹溾攢鈹€ validators.py           # 鏍￠獙锛堟棩鏈?鐩掑瓙/浣嶇疆/瀹屾暣鎬э級
鈹?  鈹溾攢鈹€ takeout_parser.py          # 鍙栧嚭鍔ㄤ綔涓嫳鏂囧綊涓€鍖?
鈹?  鈹溾攢鈹€ operations.py           # ID/浣嶇疆鏌ユ壘
鈹?  鈹溾攢鈹€ custom_fields.py        # 鑷畾涔夊瓧娈电鐞?
鈹?  鈹溾攢鈹€ csv_export.py           # CSV 瀵煎嚭
鈹?  鈹溾攢鈹€ position_fmt.py         # 鐩掑瓙甯冨眬涓庝綅缃绠?
鈹?  鈹溾攢鈹€ plan_item_factory.py    # 璁″垝椤规瀯寤?
鈹?  鈹斺攢鈹€ plan_store.py           # 璁″垝鏆傚瓨鍖?
鈹?
鈹溾攢鈹€ agent/                      # AI Agent 杩愯鏃?
鈹?  鈹溾攢鈹€ react_agent.py          # ReAct 寰幆锛堟帹鐞?+ 宸ュ叿璋冪敤锛?
鈹?  鈹溾攢鈹€ llm_client.py           # LLM 瀹㈡埛绔紙DeepSeek / 鏅鸿氨锛?
鈹?  鈹斺攢鈹€ tool_runner.py          # 宸ュ叿璋冨害 + 璁″垝鏆傚瓨鎷︽埅锛堝綋鍓嶅 LLM 鏆撮湶 14 涓伐鍏凤級
鈹?
鈹溾攢鈹€ app_gui/                    # 妗岄潰 GUI
鈹?  鈹溾攢鈹€ main.py                 # 鍏ュ彛
鈹?  鈹溾攢鈹€ gui_config.py           # GUI 閰嶇疆绠＄悊
鈹?  鈹溾攢鈹€ tool_bridge.py          # GUI 鈫?Tool API 閫傞厤鍣?
鈹?  鈹溾攢鈹€ plan_model.py           # 璁″垝鏁版嵁妯″瀷
鈹?  鈹溾攢鈹€ plan_executor.py        # 璁″垝鎵ц鍣?
鈹?  鈹溾攢鈹€ plan_gate.py            # 璁″垝鏍￠獙闂ㄦ帶
鈹?  鈹溾攢鈹€ plan_preview.py         # 璁″垝棰勮
鈹?  鈹溾攢鈹€ plan_outcome.py         # 鎵ц缁撴灉灞曠ず
鈹?  鈹溾攢鈹€ audit_guide.py          # 瀹¤寮曞
鈹?  鈹溾攢鈹€ event_compactor.py      # 浜嬩欢鍘嬬缉
鈹?  鈹溾攢鈹€ ui/
鈹?  鈹?  鈹溾攢鈹€ overview_panel.py   # 鎬昏闈㈡澘锛?脳9 缃戞牸锛?
鈹?  鈹?  鈹溾攢鈹€ operations_panel.py # 鎿嶄綔闈㈡澘锛堣〃鍗?+ 璁″垝锛?
鈹?  鈹?  鈹溾攢鈹€ ai_panel.py         # AI Copilot 闈㈡澘
鈹?  鈹?  鈹溾攢鈹€ theme.py            # 涓婚绠＄悊
鈹?  鈹?  鈹溾攢鈹€ utils.py            # UI 宸ュ叿鍑芥暟
鈹?  鈹?  鈹斺攢鈹€ workers.py          # 鍚庡彴宸ヤ綔绾跨▼
鈹?  鈹溾攢鈹€ i18n/translations/      # 缈昏瘧鏂囦欢
鈹?  鈹?  鈹溾攢鈹€ en.json
鈹?  鈹?  鈹斺攢鈹€ zh-CN.json
鈹?  鈹斺攢鈹€ assets/                 # 闈欐€佽祫婧?
鈹?      鈹斺攢鈹€ default_prompt.txt  # 榛樿 AI 鎻愮ず璇?
鈹?
鈹溾攢鈹€ tests/                      # 鍗曞厓娴嬭瘯锛坧ytest锛?
鈹溾攢鈹€ demo/                       # Demo 鏁版嵁闆?
鈹?  鈹斺攢鈹€ ln2_inventory.demo.yaml
鈹溾攢鈹€ installer/                  # Windows 瀹夎鍖呰祫婧?
鈹?  鈹斺攢鈹€ windows/
鈹?      鈹溾攢鈹€ LN2InventoryAgent.iss
鈹?      鈹斺攢鈹€ build_installer.bat
鈹溾攢鈹€ requirements.txt            # Python 渚濊禆
鈹溾攢鈹€ ln2_inventory.spec          # PyInstaller 鏋勫缓閰嶇疆
鈹斺攢鈹€ LICENSE                     # MIT
```

---

## 渚濊禆

| 鍖?| 鐗堟湰 | 鐢ㄩ€?|
|----|------|------|
| PyYAML | >= 5.0 | YAML 鏁版嵁璇诲啓 |
| mistune | >= 2.0 | Markdown 娓叉煋锛圓I 鍥炲锛?|
| PySide6 | 鈥?| 妗岄潰 GUI锛堝彲閫夛級 |

Python 3.8+

---

## 璁稿彲璇?

[MIT](LICENSE) - Copyright (c) 2026 Yiming Fan

---

## 鏀寔涓€涓?

濡傛灉杩欎釜椤圭洰瀵逛綘鏈夊府鍔╋紝娆㈣繋璇锋垜鍠濇澂鍜栧暋 :)

<img src="app_gui/assets/donate.png" width="200" alt="璧炶祻鐮? />

